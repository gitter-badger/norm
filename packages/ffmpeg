#!/bin/bash

depends_on pkg-config
depends_on yasm
depends_on libopus
depends_on speex
depends_on libwebp
depends_on x264
depends_on libvorbis
depends_on libxvid
depends_on libfaac
depends_on libtheora
depends_on lame
depends_on libva
depends_on bzip2
depends_on libxv

X265_CONFIGURE=
if have_gcc 4.4; then
    depends_on x265
    X265_CONFIGURE=--enable-libx265
fi

fetch_source https://www.ffmpeg.org/releases/ffmpeg-2.7.2.tar.xz 04e2c4ec8fb5e431e08a857b13f4f9077050a06a

do_unpack_compile --enable-pthreads --enable-gpl --enable-version3 \
                  --enable-shared \
                  --enable-hardcoded-tables --enable-avresample \
                  --enable-nonfree \
                  --enable-libx264 \
                  $X265_CONFIGURE \
                  --enable-libmp3lame \
                  --enable-libxvid \
                  --enable-libtheora \
                  --enable-libvorbis \
                  --enable-libfaac \
                  --enable-ffplay \
                  --enable-libspeex \
                  --enable-libopus \
                  --enable-libwebp
